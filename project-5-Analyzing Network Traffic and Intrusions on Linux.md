# Project: Analyzing Network Traffic and Intrusions on Linux

## Introduction
Network traffic analysis is a crucial aspect of forensic investigations, providing insights into potential intrusions and malicious activities. This project will guide you through the process of capturing, analyzing, and interpreting network traffic on a Linux system. You will learn how to use various tools and techniques to detect and analyze network intrusions.

## Objective
The objective of this project is to provide hands-on experience in analyzing network traffic and detecting intrusions on Linux systems. By the end of this project, you will be able to effectively use forensic tools to capture and analyze network traffic, identifying potential security incidents.

## Lab Setup and Tools
To complete this project, you will need access to a Linux operating system. You can use a physical machine, set up a virtual machine using software like VirtualBox or VMware, or use a cloud-based Linux instance.

### Pre-requisites
- Basic understanding of Linux OS and command-line interface
- Administrative privileges on the Linux machine

### Tools Installation
For this project, we will use the following tools:
1. **Wireshark**: A network protocol analyzer.
2. **tcpdump**: A command-line packet analyzer.
3. **Suricata**: An open-source network threat detection engine.

#### Installing Wireshark
1. Install Wireshark using the package manager:
    ```bash
    sudo apt-get install wireshark
    ```

#### Installing tcpdump
1. Install tcpdump using the package manager:
    ```bash
    sudo apt-get install tcpdump
    ```

#### Installing Suricata
1. Install Suricata using the package manager:
    ```bash
    sudo apt-get install suricata
    ```

## Exercises

### Exercise 1: Capturing Network Traffic with tcpdump
**Objective**: Learn how to capture network traffic using tcpdump.

**Steps**:
1. Open a terminal.
2. Use tcpdump to capture network traffic on a specific interface (e.g., eth0):
    ```bash
    sudo tcpdump -i eth0 -w capture.pcap
    ```
3. Generate some network traffic by browsing the web or using networked applications.
4. Stop the capture by pressing `Ctrl+C`.

**Expected Output**: You should have a capture file (`capture.pcap`) containing the network traffic for the specified interface.

### Exercise 2: Analyzing Network Traffic with Wireshark
**Objective**: Use Wireshark to analyze captured network traffic.

**Steps**:
1. Open Wireshark.
2. Open the capture file (`capture.pcap`) created in Exercise 1.
3. Use Wireshark's interface to navigate through the captured packets.
4. Apply filters to focus on specific traffic types (e.g., HTTP, DNS):
    - For HTTP: `http`
    - For DNS: `dns`

**Expected Output**: You should be able to analyze the captured network traffic, identifying and interpreting different types of network communications.

### Exercise 3: Detecting Intrusions with Suricata
**Objective**: Use Suricata to detect potential network intrusions.

**Steps**:
1. Ensure Suricata is installed and configured.
2. Run Suricata to analyze network traffic in real-time:
    ```bash
    sudo suricata -i eth0 -c /etc/suricata/suricata.yaml -l /var/log/suricata/
    ```
3. Generate some network traffic that might trigger alerts (e.g., access a known malicious URL or use network scanning tools).
4. Review the Suricata logs for alerts:
    ```bash
    cat /var/log/suricata/fast.log
    ```

**Expected Output**: You should be able to see alerts generated by Suricata, indicating potential network intrusions.

### Exercise 4: Extracting Files from Network Traffic
**Objective**: Learn how to extract files transferred over the network from captured traffic.

**Steps**:
1. Open Wireshark and load the capture file (`capture.pcap`).
2. Use Wireshark to locate file transfer protocols (e.g., HTTP, FTP).
3. Follow the TCP stream to reconstruct the file transfer.
4. Extract the file from the network traffic using Wireshark's export feature.

**Expected Output**: You should be able to extract files transferred over the network from the captured traffic.

### Exercise 5: Correlating Network Traffic with System Logs
**Objective**: Correlate network traffic analysis with system logs to gain a comprehensive understanding of potential security incidents.

**Steps**:
1. Use Wireshark and Suricata to identify suspicious network activity.
2. Check the system logs (e.g., `/var/log/auth.log`, `/var/log/syslog`) for related events:
    ```bash
    sudo grep "suspicious_activity" /var/log/auth.log
    sudo grep "suspicious_activity" /var/log/syslog
    ```
3. Correlate the timestamps and details of network traffic with the system log entries.

**Expected Output**: You should be able to correlate network traffic with system logs, providing a comprehensive view of potential security incidents.

---

With these exercises, you will gain practical experience in analyzing network traffic and detecting intrusions on Linux systems. This will enhance your skills in network forensics and help you effectively investigate security incidents by uncovering valuable evidence from network traffic.
