# Project 1: Investigating Linux System Logs for Security Incidents

## Introduction
Linux system logs are a crucial source of information for identifying and investigating security incidents. This project will guide you through the process of analyzing Linux system logs to detect potential security threats. You will learn how to access, interpret, and utilize these logs to identify suspicious activities and mitigate risks.

## Objective
The objective of this project is to provide hands-on experience in investigating Linux system logs to detect and analyze security incidents. By the end of this project, you will be able to effectively use various tools and techniques to examine system logs and identify potential security issues.

## Lab Setup and Tools
To complete this project, you will need access to a Linux operating system. You can use a physical machine, set up a virtual machine using software like VirtualBox or VMware, or use a cloud-based Linux instance.

### Pre-requisites
- Basic understanding of Linux OS and command-line interface
- Administrative privileges on the Linux machine

### Tools Installation
For this project, we will use the following tools:
1. **Syslog**: A standard for message logging.
2. **Logwatch**: A log analysis tool.
3. **Grep**: A command-line utility for searching plain-text data.
4. **Auditd**: A userspace component to collect audit data.

#### Installing Logwatch
1. Install Logwatch using the package manager:
    ```bash
    sudo apt-get install logwatch
    ```

#### Installing Auditd
1. Install Auditd using the package manager:
    ```bash
    sudo apt-get install auditd
    ```

## Exercises

### Exercise 1: Accessing and Understanding Linux System Logs
**Objective**: Learn how to access and navigate through various Linux system logs.

**Steps**:
1. Open a terminal.
2. Navigate to the `/var/log` directory:
    ```bash
    cd /var/log
    ```
3. List the log files in this directory:
    ```bash
    ls -l
    ```
4. Use `cat`, `less`, or `tail` to view the contents of common log files such as `syslog`, `auth.log`, and `kern.log`:
    ```bash
    cat syslog
    less auth.log
    tail -f kern.log
    ```

**Expected Output**: You should be able to see and navigate through various log files, understanding their basic structure and contents.

### Exercise 2: Filtering Logs for Specific Events using Grep
**Objective**: Learn how to use `grep` to search for specific events or patterns in log files.

**Steps**:
1. Open a terminal.
2. Navigate to the `/var/log` directory:
    ```bash
    cd /var/log
    ```
3. Use `grep` to search for failed login attempts in `auth.log`:
    ```bash
    grep "Failed password" auth.log
    ```
4. Use `grep` to search for kernel errors in `kern.log`:
    ```bash
    grep "error" kern.log
    ```

**Expected Output**: You should be able to filter log files for specific events or patterns using `grep`, identifying relevant log entries.

### Exercise 3: Analyzing Logs with Logwatch
**Objective**: Use Logwatch to generate and review log analysis reports.

**Steps**:
1. Open a terminal.
2. Run Logwatch to generate a report for the previous day:
    ```bash
    sudo logwatch --detail High --mailto your-email@example.com --range Yesterday
    ```
3. Review the generated report in your email or specified output location.

**Expected Output**: You should receive a detailed log analysis report generated by Logwatch, summarizing key events and activities.

### Exercise 4: Monitoring Real-Time Logs using Tail
**Objective**: Learn how to monitor logs in real-time using the `tail` command.

**Steps**:
1. Open a terminal.
2. Navigate to the `/var/log` directory:
    ```bash
    cd /var/log
    ```
3. Use `tail` to monitor the `syslog` file in real-time:
    ```bash
    sudo tail -f syslog
    ```
4. In another terminal, trigger some log events (e.g., by attempting a failed login or restarting a service) and observe the real-time log output.

**Expected Output**: You should be able to monitor real-time log entries using `tail`, observing new log events as they occur.

### Exercise 5: Using Auditd to Track System Events
**Objective**: Use Auditd to set up and analyze audit rules for tracking specific system events.

**Steps**:
1. Open a terminal.
2. Ensure the `auditd` service is running:
    ```bash
    sudo service auditd start
    ```
3. Add an audit rule to track all `chmod` commands:
    ```bash
    sudo auditctl -w /bin/chmod -p x -k chmod_changes
    ```
4. Generate some audit logs by running `chmod` commands:
    ```bash
    chmod 755 somefile
    ```
5. Search the audit logs for `chmod` events:
    ```bash
    sudo ausearch -k chmod_changes
    ```

**Expected Output**: You should be able to set up and analyze audit rules using Auditd, tracking specific system events and generating relevant logs.

---

With these exercises, you will gain practical experience in investigating Linux system logs for security incidents, leveraging various tools and techniques to enhance your analysis capabilities.
